{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Riya\\\\OneDrive\\\\Desktop\\\\trader-among-us-master\\\\src\\\\components\\\\Bid\\\\Bid.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { DragDropContext } from \"react-beautiful-dnd\";\nimport \"./Bid.css\";\nimport Column from \"../../components/Column/Column\";\nimport postsApi from \"../../utils/posts-api\";\nimport itemsApi from \"../../utils/items-api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst data = {\n  items: {\n    \"itm-1\": {\n      id: \"itm-1\",\n      name: \"item1\",\n      description: \"somedes\",\n      img: \"https://cdn.greatlifepublishing.net/wp-content/uploads/sites/4/2015/10/23150611/coffee-grinder-715170_960_720.jpg\"\n    },\n    \"itm-2\": {\n      id: \"itm-2\",\n      name: \"item2\",\n      description: \"somedes\",\n      img: \"https://wl-brightside.cf.tsp.li/resize/728x/jpg/181/4fb/2a0b6e52e29e3ba58697034db7.jpg\"\n    },\n    \"itm-3\": {\n      id: \"itm-3\",\n      name: \"item3\",\n      description: \"somedes\",\n      img: \"https://thumbs.dreamstime.com/b/kitchen-antique-items-rural-life-composition-objects-dark-background-194158844.jpg\"\n    }\n  },\n  columns: {\n    \"col-1\": {\n      id: \"col-1\",\n      title: \"Your Items\",\n      itemIds: [\"itm-1\", \"itm-2\", \"itm-3\"]\n    },\n    \"col-2\": {\n      id: \"col-2\",\n      title: \"Bid Items\",\n      itemIds: []\n    }\n  },\n  columnOrder: [\"col-1\", \"col-2\"]\n};\nexport default function Bid(props) {\n  _s();\n\n  const userId = props.user._id;\n  const [bid, setBid] = useState({\n    itemsOffered: [],\n    description: \"\"\n  });\n  const [message, setMessage] = useState(\"\");\n\n  const loadItems = async () => {\n    const res = await itemsApi.show(userId);\n    const itemsForDrag = res.item;\n    /** here we transform the database array to our object for the dragging\n      items = [\n        {id: \"60c9656bdb21932de0551b9e\", name: \"WOWOW\", img: \"2084aec2257e16c1dea5d9054cb1e286\"},\n      ]\n      TO\n      itemsHere = {\n        \"60c9656bdb21932de0551b9e\": { id: \"60c9656bdb21932de0551b9e\", name: \"WOWOW\", img: \"2084aec2257e16c1dea5d9054cb1e286\"}\n      }\n    */\n\n    let itemIds = itemsForDrag.map(item => item._id);\n    data.columns[\"col-1\"].itemIds = itemIds;\n    itemsForDrag.forEach(item => {\n      data.items[item._id] = {\n        id: item._id,\n        name: item.title,\n        img: item.image\n      };\n    });\n  };\n\n  useEffect(() => {\n    loadItems();\n  }, []);\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n\n    if (!bid.description) {\n      setMessage(\"Please enter a description\");\n      return;\n    } else {\n      bid.itemsOffered = items.columns[\"col-2\"].itemIds;\n      await postsApi.makeBid(props.postId, bid);\n      props.loadPosts();\n      handleHidden();\n      setMessage(\"\");\n    }\n  }\n\n  function handleBidChange(e) {\n    e.preventDefault();\n    setBid({ ...bid,\n      [e.target.name]: e.target.value\n    });\n  }\n\n  const [items, setItems] = useState(data);\n  const columns = items.columnOrder;\n  const [hidden, setHidden] = useState(\"\");\n  const [icon, setIcon] = useState(\"+\");\n  const [block, setBlock] = useState(\"\");\n\n  const handleHidden = () => {\n    if (hidden === \"hidden\") setHidden(\"\");\n    if (hidden === \"\") setHidden(\"hidden\");\n    if (icon === \"+\") setIcon(\"-\");\n    if (icon === \"-\") setIcon(\"+\");\n    if (block === \"show-bid-form\") setBlock(\"\");\n    if (block === \"\") setBlock(\"show-bid-form\");\n  };\n\n  const onDragEnd = result => {\n    const {\n      destination,\n      source,\n      draggableId\n    } = result; //Out of bounds\n\n    if (!destination) return; //Same Location\n\n    if (destination.droppableId === source.droppableId && destination.index === source.index) {\n      return;\n    }\n\n    const start = items.columns[source.droppableId];\n    const end = items.columns[destination.droppableId]; //Moving within same column\n\n    if (start === end) {\n      const newItemIds = Array.from(start.itemIds);\n      newItemIds.splice(source.index, 1);\n      newItemIds.splice(destination.index, 0, draggableId);\n      const newStartColumn = { ...start,\n        itemIds: newItemIds\n      };\n      const newState = { ...items,\n        columns: { ...items.columns,\n          [newStartColumn.id]: newStartColumn\n        }\n      };\n      setItems(newState);\n      return;\n    } //Moving to different column\n\n\n    const startItemIds = Array.from(start.itemIds);\n    startItemIds.splice(source.index, 1);\n    const newStart = { ...start,\n      itemIds: startItemIds\n    };\n    const endItemIds = Array.from(end.itemIds);\n    endItemIds.splice(destination.index, 0, draggableId);\n    const newEnd = { ...end,\n      itemIds: endItemIds\n    };\n    const newState = { ...items,\n      columns: { ...items.columns,\n        [newStart.id]: newStart,\n        [newEnd.id]: newEnd\n      }\n    };\n    setItems(newState);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"PostIdPage post-page-row\",\n      children: /*#__PURE__*/_jsxDEV(\"h3\", {\n        onClick: handleHidden,\n        className: \"post-btn\",\n        children: \"Make A Bid\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bid-container \",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: `txt-area-col ${block}`,\n        children: \"Drag and drop to make a bid\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `Bid-body-row ${hidden}`,\n        children: /*#__PURE__*/_jsxDEV(DragDropContext, {\n          className: \"Bid-list\",\n          onDragEnd: onDragEnd,\n          children: columns.map(colId => {\n            const column = items.columns[colId];\n            const res = column.itemIds.map(itemId => items.items[itemId]);\n            return /*#__PURE__*/_jsxDEV(Column, {\n              column: column,\n              res: res\n            }, column.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 22\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `txt-area-col ${block}`,\n        children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"bid-text-area\",\n          onChange: handleBidChange,\n          value: bid.description,\n          style: {\n            height: \"15vh\"\n          },\n          placeholder: \"Now's your chance, make your pitch!\",\n          name: \"description\",\n          id: \"description\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `txt-area-col ${block}`,\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          onClick: handleSubmit,\n          className: \"post-btn\",\n          children: \"Confirm Bid\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"bid-message\",\n        children: message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Bid, \"DzdCx4xStVhKcb3yrFMuXjMLULg=\");\n\n_c = Bid;\n\nvar _c;\n\n$RefreshReg$(_c, \"Bid\");","map":{"version":3,"sources":["C:/Users/Riya/OneDrive/Desktop/trader-among-us-master/src/components/Bid/Bid.jsx"],"names":["React","useState","useEffect","DragDropContext","Column","postsApi","itemsApi","data","items","id","name","description","img","columns","title","itemIds","columnOrder","Bid","props","userId","user","_id","bid","setBid","itemsOffered","message","setMessage","loadItems","res","show","itemsForDrag","item","map","forEach","image","handleSubmit","e","preventDefault","makeBid","postId","loadPosts","handleHidden","handleBidChange","target","value","setItems","hidden","setHidden","icon","setIcon","block","setBlock","onDragEnd","result","destination","source","draggableId","droppableId","index","start","end","newItemIds","Array","from","splice","newStartColumn","newState","startItemIds","newStart","endItemIds","newEnd","colId","column","itemId","height"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { DragDropContext } from \"react-beautiful-dnd\";\nimport \"./Bid.css\";\nimport Column from \"../../components/Column/Column\";\nimport postsApi from \"../../utils/posts-api\";\nimport itemsApi from \"../../utils/items-api\";\n\nconst data = {\n  items: {\n    \"itm-1\": {\n      id: \"itm-1\",\n      name: \"item1\",\n      description: \"somedes\",\n      img: \"https://cdn.greatlifepublishing.net/wp-content/uploads/sites/4/2015/10/23150611/coffee-grinder-715170_960_720.jpg\"\n    },\n    \"itm-2\": {\n      id: \"itm-2\",\n      name: \"item2\",\n      description: \"somedes\",\n      img: \"https://wl-brightside.cf.tsp.li/resize/728x/jpg/181/4fb/2a0b6e52e29e3ba58697034db7.jpg\"\n    },\n    \"itm-3\": {\n      id: \"itm-3\",\n      name: \"item3\",\n      description: \"somedes\",\n      img: \"https://thumbs.dreamstime.com/b/kitchen-antique-items-rural-life-composition-objects-dark-background-194158844.jpg\"\n    },\n  },\n  columns: {\n    \"col-1\": {\n      id: \"col-1\",\n      title: \"Your Items\",\n      itemIds: [\"itm-1\", \"itm-2\", \"itm-3\"]\n    },\n    \"col-2\": {\n      id: \"col-2\",\n      title: \"Bid Items\",\n      itemIds: [],\n    },\n  },\n  columnOrder: [\"col-1\", \"col-2\"],\n};\n\n\nexport default function Bid(props) {\n  const userId = props.user._id;\n\n  const [bid, setBid] = useState({\n    itemsOffered: [],\n    description: \"\"\n  });\n\n\n  const [message, setMessage] = useState(\"\");\n\n  const loadItems = async () => {\n    const res = await itemsApi.show(userId);\n    const itemsForDrag = res.item;\n\n    /** here we transform the database array to our object for the dragging\n      items = [\n        {id: \"60c9656bdb21932de0551b9e\", name: \"WOWOW\", img: \"2084aec2257e16c1dea5d9054cb1e286\"},\n      ]\n      TO\n      itemsHere = {\n        \"60c9656bdb21932de0551b9e\": { id: \"60c9656bdb21932de0551b9e\", name: \"WOWOW\", img: \"2084aec2257e16c1dea5d9054cb1e286\"}\n      }\n    */\n\n    let itemIds = itemsForDrag.map(item => item._id);\n    data.columns[\"col-1\"].itemIds = itemIds;\n    itemsForDrag.forEach(item => {\n      data.items[item._id] = {\n        id: item._id,\n        name: item.title,\n        img: item.image,\n      };\n    });\n  };\n\n  useEffect(() => {\n    loadItems();\n  }, []);\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    if (!bid.description) {\n      setMessage(\"Please enter a description\");\n      return;\n    } else {\n      bid.itemsOffered = items.columns[\"col-2\"].itemIds;\n      await postsApi.makeBid(props.postId, bid);\n      props.loadPosts();\n      handleHidden();\n      setMessage(\"\");\n    }\n  }\n\n  function handleBidChange(e) {\n    e.preventDefault();\n\n    setBid({ ...bid, [e.target.name]: e.target.value });\n  }\n\n  const [items, setItems] = useState(data);\n\n\n  const columns = items.columnOrder;\n\n  const [hidden, setHidden] = useState(\"\");\n  const [icon, setIcon] = useState(\"+\");\n  const [block, setBlock] = useState(\"\");\n\n  const handleHidden = () => {\n    if (hidden === \"hidden\") setHidden(\"\");\n    if (hidden === \"\") setHidden(\"hidden\");\n    if (icon === \"+\") setIcon(\"-\");\n    if (icon === \"-\") setIcon(\"+\");\n    if (block === \"show-bid-form\") setBlock(\"\");\n    if (block === \"\") setBlock(\"show-bid-form\");\n  };\n\n  const onDragEnd = result => {\n    const { destination, source, draggableId } = result;\n    //Out of bounds\n    if (!destination) return;\n    //Same Location\n    if (\n      destination.droppableId === source.droppableId &&\n      destination.index === source.index\n    ) {\n      return;\n    }\n\n    const start = items.columns[source.droppableId];\n    const end = items.columns[destination.droppableId];\n    //Moving within same column\n    if (start === end) {\n      const newItemIds = Array.from(start.itemIds);\n\n      newItemIds.splice(source.index, 1);\n      newItemIds.splice(destination.index, 0, draggableId);\n\n      const newStartColumn = {\n        ...start,\n        itemIds: newItemIds,\n      };\n\n      const newState = {\n        ...items,\n        columns: {\n          ...items.columns,\n          [newStartColumn.id]: newStartColumn,\n        }\n      };\n\n      setItems(newState);\n      return;\n    }\n\n    //Moving to different column\n    const startItemIds = Array.from(start.itemIds);\n    startItemIds.splice(source.index, 1);\n    const newStart = {\n      ...start,\n      itemIds: startItemIds,\n    };\n\n    const endItemIds = Array.from(end.itemIds);\n    endItemIds.splice(destination.index, 0, draggableId);\n    const newEnd = {\n      ...end,\n      itemIds: endItemIds,\n    };\n\n    const newState = {\n      ...items,\n      columns: {\n        ...items.columns,\n        [newStart.id]: newStart,\n        [newEnd.id]: newEnd,\n      }\n    };\n    setItems(newState);\n  };\n\n  return (\n    <>\n      <div className=\"PostIdPage post-page-row\">\n        <h3 onClick={handleHidden} className=\"post-btn\">Make A Bid</h3>\n      </div>\n\n      <div className={\"bid-container \"}>\n        <p className={`txt-area-col ${block}`}>Drag and drop to make a bid</p>\n        <div className={`Bid-body-row ${hidden}`}>\n          <DragDropContext className=\"Bid-list\" onDragEnd={onDragEnd}>\n            {columns.map((colId) => {\n              const column = items.columns[colId];\n              const res = column.itemIds.map(itemId => items.items[itemId]);\n              return <Column key={column.id} column={column} res={res} />;\n            })}\n          </DragDropContext>\n        </div>\n        <div className={`txt-area-col ${block}`}>\n          <textarea\n            className=\"bid-text-area\"\n            onChange={handleBidChange}\n            value={bid.description}\n            style={{ height: \"15vh\" }}\n            placeholder=\"Now's your chance, make your pitch!\"\n            name=\"description\"\n            id=\"description\"\n          />\n        </div>\n        <div className={`txt-area-col ${block}`}>\n          <h3 onClick={handleSubmit} className={\"post-btn\"}>Confirm Bid</h3>\n        </div>\n        <h3 className=\"bid-message\">{message}</h3>\n      </div>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}